README

This code is a Chrome Extension code that adds a "Copy" button to the response of a chatGPT API. The script is designed to run in a browser environment.
(Author's note: This code, as well as the content of readme file, is heavily generated by chatGPT 4!)

How it Works

The script uses the requestIdleCallback and setInterval functions to continuously check if the document body and head have been loaded, and if the chatGPT response has been received. If the conditions are met, the script will search the page for the chatGPT response using the CSS selector "[d='M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3']" and add a "Copy" button to each response.

When the "Copy" button is clicked, the text of the chatGPT response is copied to the clipboard using the navigator.clipboard.writeText method. The script also includes error handling for cases where the text could not be copied to the clipboard.

Implementation Details

The script uses the requestIdleCallback function to schedule the injectSyncButton function to run when the browser is idle. The setInterval function is used to run the injectSyncButton function every 2 seconds. This allows the script to continuously check if the document body and head have been loaded, and if the chatGPT response has been received.

The injectSyncButton function uses the document.querySelectorAll method to search the page for the chatGPT response using the CSS selector "[d='M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3']". For each response, the function creates a "Copy" button and adds it to the response using the document.createElement and appendChild methods.

The "Copy" button is given the style margin-left: 10px to provide a margin between the button and the response text. The script also includes a check to ensure that the "Copy" button is not added multiple times to the same response by checking the name attribute of the last child of the response element.

Conclusion

This code provides a simple solution for adding a "Copy" button to the response of a chatGPT API in a browser environment. By using the requestIdleCallback and setInterval functions, the script is able to continuously check for the chatGPT response and add the "Copy" button when it becomes available. The script is designed to be easy to implement and customize to meet specific requirements.